# LegalOS - Project TODO

## é¡¹ç›®æ¦‚è¿°

**é¡¹ç›®åç§°**: LegalOS - ä¼ä¸šçº§æ³•å¾‹æ™ºèƒ½åˆ†æç³»ç»Ÿ
**æ¶æ„**: åŸºäº LangGraph çš„å¤šæ™ºèƒ½ä½“ RAG ç³»ç»Ÿ
**å½“å‰çŠ¶æ€**: Phase 1 å®Œæˆï¼ŒPhase 2 éƒ¨åˆ†å®Œæˆ
**æœ€åæ›´æ–°**: 2026-01-18

---

## ğŸ“Š æ•´ä½“è¿›åº¦

### Phase 1: é¡¹ç›®è„šæ‰‹æ¶ä¸åŸºç¡€è®¾æ–½ âœ… 100%
- [x] é¡¹ç›®ç»“æ„æ­å»º
- [x] æ•°æ®åº“ä¸ ORM é…ç½®
- [x] FastAPI åŸºç¡€æ¡†æ¶
- [x] Next.js å‰ç«¯æ¡†æ¶
- [x] Docker é›†æˆ

### Phase 2: RAG æ¨¡å—å®ç° ğŸŸ¡ 35%
- [x] Stage 2.1: æ–‡æ¡£åŠ è½½ä¸å¤„ç† (100%)
- [x] Stage 2.2: æ–‡æ¡£åˆ†å— (100%)
- [ ] Stage 2.3: åµŒå…¥ä¸å‘é‡å­˜å‚¨ (å¾…é›†æˆ)
- [ ] Stage 2.4: BM25 æ£€ç´¢ (å¾…å®ç°)
- [ ] Stage 2.5: æ··åˆæ£€ç´¢ä¸é‡æ’åº (å¾…å®ç°)
- [ ] Stage 2.6: RAG API ç«¯ç‚¹ (å¾…é›†æˆ)
- [ ] Stage 2.7: RAG æµ‹è¯• UI (å¾…å®ç°)

### Phase 3: å¤šæ™ºèƒ½ä½“ç³»ç»Ÿ âŒ 0%
- [ ] Stage 3.1: LangGraph å·¥ä½œæµè®¾ç½®
- [ ] Stage 3.2: åè°ƒæ™ºèƒ½ä½“
- [ ] Stage 3.3: æ£€ç´¢æ™ºèƒ½ä½“
- [ ] Stage 3.4: åˆ†ææ™ºèƒ½ä½“
- [ ] Stage 3.5: å®¡æŸ¥æ™ºèƒ½ä½“
- [ ] Stage 3.6: éªŒè¯æ™ºèƒ½ä½“
- [ ] Stage 3.7: æŠ¥å‘Šæ™ºèƒ½ä½“
- [ ] Stage 3.8: æ™ºèƒ½ä½“ç¼–æ’
- [ ] Stage 3.9: æ™ºè°± AI é›†æˆ
- [ ] Stage 3.10: åˆåŒåˆ†æ API

### Phase 4: å‰ç«¯ä¸é›†æˆ ğŸŸ¡ 20%
- [ ] Stage 4.1: åˆåŒä¸Šä¼ é¡µé¢ (åŸºç¡€ç‰ˆå·²å®ç°)
- [ ] Stage 4.2: åˆ†æè¿›åº¦é¡µé¢ (å¾…å®ç°)
- [ ] Stage 4.3: å®¡æŸ¥æŠ¥å‘Šé¡µé¢ (å¾…å®ç°)
- [ ] Stage 4.4: ç«¯åˆ°ç«¯é›†æˆ (å¾…å®ç°)
- [ ] Stage 4.5: æŠ¥å‘Šå¯¼å‡ºåŠŸèƒ½ (å¾…å®ç°)

### Phase 5: è¯„ä¼°ä¸ä¼˜åŒ– âŒ 0%
- [ ] Stage 5.1: é»„é‡‘æ•°æ®é›†åˆ›å»º
- [ ] Stage 5.2: è¯„ä¼°æŒ‡æ ‡å®ç°
- [ ] Stage 5.3: åŸºçº¿å®éªŒ
- [ ] Stage 5.4: æç¤ºè¯ä¼˜åŒ–
- [ ] Stage 5.5: æ£€ç´¢ä¼˜åŒ–
- [ ] Stage 5.6: æ€§èƒ½ä¼˜åŒ–
- [ ] Stage 5.7: è¯„ä¼°ä»ªè¡¨æ¿

### Phase 6: è¿ç»´ä¸éƒ¨ç½² âŒ 0%
- [ ] Stage 6.1: æ—¥å¿—ç³»ç»Ÿ
- [ ] Stage 6.2: ç›‘æ§ä¸æŒ‡æ ‡
- [ ] Stage 6.3: é“¾è·¯è¿½è¸ª
- [ ] Stage 6.4: å®‰å…¨åŠ å›º
- [ ] Stage 6.5: æ–‡æ¡£
- [ ] Stage 6.6: ç”Ÿäº§éƒ¨ç½²
- [ ] Stage 6.7: å‹åŠ›æµ‹è¯•ä¸ä¼˜åŒ–
- [ ] Stage 6.8: æœ€ç»ˆäº¤ä»˜

---

## ğŸ¯ ä¼˜å…ˆçº§ä»»åŠ¡

### P0 - å…³é”®é›†æˆä»»åŠ¡

#### åç«¯
- [ ] **é›†æˆ RAG è·¯ç”±åˆ° main.py**
  - å¯¼å…¥å¹¶æ³¨å†Œ `app.api.rag_routes.router`
  - æ›´æ–°åº”ç”¨å¯åŠ¨ä»¥åˆå§‹åŒ– RAG ç®¡é“
  - å°† RAG ç®¡é“æ·»åŠ åˆ°ä¾èµ–æ³¨å…¥
  - æ–‡ä»¶ä½ç½®: `backend/app/main.py`

- [ ] **å¯åŠ¨æ—¶åˆå§‹åŒ– RAG ç®¡é“**
  - åˆ›å»º RAGPipeline å®ä¾‹ (LLM + Retrieval + VectorStore)
  - ä»ç¯å¢ƒå˜é‡é…ç½® OpenAI API å¯†é’¥
  - ä»é…ç½®ä¸­è¿æ¥ Qdrant
  - åœ¨ RAGService å•ä¾‹ä¸­è®¾ç½®ç®¡é“
  - æ–‡ä»¶ä½ç½®: `backend/app/main.py`, `backend/app/rag/`

- [ ] **å®ç°æ–‡æ¡£ä¸Šä¼ å¤„ç†**
  - è¿æ¥ `POST /api/v1/documents/upload` åˆ°å®é™…ç®¡é“
  - é›†æˆ DocumentProcessor ä¸åˆ†å—
  - ç”ŸæˆåµŒå…¥å¹¶å­˜å‚¨åˆ°å‘é‡æ•°æ®åº“
  - ä¿å­˜æ–‡æ¡£å…ƒæ•°æ®åˆ° PostgreSQL
  - æ–‡ä»¶ä½ç½®: `backend/app/api/v1/documents.py`

- [ ] **åˆ›å»ºå¹¶åº”ç”¨æ•°æ®åº“è¿ç§»**
  - ä¸º Document å’Œ KnowledgeChunk æ¨¡å‹ç”Ÿæˆ Alembic è¿ç§»
  - å°† pgvector æ‰©å±•æ·»åŠ åˆ°è¿ç§»
  - æµ‹è¯•è¿ç§» up/down
  - åº”ç”¨åˆå§‹è¿ç§»
  - æ–‡ä»¶ä½ç½®: `backend/alembic/versions/`

#### å‰ç«¯
- [ ] **å®ç°åˆ†æè¿›åº¦é¡µé¢**
  - åˆ›å»º WebSocket å®¢æˆ·ç«¯è¿æ¥
  - æ˜¾ç¤ºå½“å‰æ™ºèƒ½ä½“/é˜¶æ®µ
  - å®æ—¶è¿›åº¦æ¡æ›´æ–°
  - æ”¯æŒå–æ¶ˆæ“ä½œ
  - æ–‡ä»¶ä½ç½®: `frontend/src/app/analysis/page.tsx`

- [ ] **å®ç°å®¡æŸ¥æŠ¥å‘Šé¡µé¢**
  - é›†æˆ PDF.js é¢„è§ˆåˆåŒ
  - æŒ‰ç±»åˆ«æ˜¾ç¤ºå‘ç°çš„é—®é¢˜
  - æ˜¾ç¤ºé£é™©çŸ©é˜µ
  - å¯¼å‡ºä¸º PDF/DOCX/JSON
  - æ–‡ä»¶ä½ç½®: `frontend/src/app/report/page.tsx`

- [ ] **ç«¯åˆ°ç«¯é›†æˆ**
  - è¿æ¥ä¸Šä¼ åˆ°åˆ†æ API
  - ä»ä¸Šä¼ å¯¼èˆªåˆ°è¿›åº¦é¡µé¢
  - ä»è¿›åº¦å¯¼èˆªåˆ°æŠ¥å‘Šé¡µé¢
  - å…¨å±€é”™è¯¯å¤„ç†
  - æ–‡ä»¶ä½ç½®: `frontend/src/app/`, `frontend/src/lib/`

### P1 - æ ¸å¿ƒåŠŸèƒ½å®ç°

#### RAG ç³»ç»Ÿ (Phase 2 ç»§ç»­)
- [ ] **Stage 2.3: åµŒå…¥ä¸å‘é‡å­˜å‚¨**
  - ä½¿ç”¨ bge-large-zh-v1.5 ç”ŸæˆåµŒå…¥
  - Qdrant å‘é‡å­˜å‚¨è®¾ç½®
  - æ‰¹é‡å¤„ç†æ”¯æŒ
  - åµŒå…¥ç¼“å­˜ (Redis)
  - æ–‡ä»¶ä½ç½®: `backend/app/rag/embeddings/`, `backend/app/rag/services/vector_store.py`

- [ ] **Stage 2.4: BM25 æ£€ç´¢**
  - ä½¿ç”¨ jieba è¿›è¡Œä¸­æ–‡åˆ†è¯
  - æ„å»º BM25 ç´¢å¼•
  - æ‰§è¡Œ BM25 æœç´¢
  - è¿”å›æ’åºç»“æœ
  - æ–‡ä»¶ä½ç½®: `backend/app/rag/retrieval/`

- [ ] **Stage 2.5: æ··åˆæ£€ç´¢ä¸é‡æ’åº**
  - ä½¿ç”¨ RRF (Reciprocal Rank Fusion) åˆå¹¶ç»“æœ
  - é›†æˆ bge-reranker-v2-m3 æ¨¡å‹
  - å®ç°é‡æ’åºç®¡é“
  - ç»“æœå»é‡
  - ä¸Šä¸‹æ–‡çª—å£ç®¡ç†
  - æ–‡ä»¶ä½ç½®: `backend/app/rag/retrieval/`

- [ ] **Stage 2.6: RAG API ç«¯ç‚¹**
  - POST /api/v1/knowledge/upload - ä¸Šä¼ æ–‡æ¡£
  - GET /api/v1/knowledge/documents - åˆ—å‡ºæ–‡æ¡£ (åˆ†é¡µ)
  - DELETE /api/v1/knowledge/documents/{id} - åˆ é™¤æ–‡æ¡£
  - POST /api/v1/knowledge/search - æœç´¢çŸ¥è¯†åº“
  - GET /api/v1/knowledge/documents/{id}/preview - é¢„è§ˆæ–‡æ¡£
  - æ–‡ä»¶ä½ç½®: `backend/app/api/v1/`

- [ ] **Stage 2.7: RAG æµ‹è¯• UI**
  - åˆ›å»ºçŸ¥è¯†åº“é¡µé¢å¢å¼º
  - å®ç°æ–‡ä»¶ä¸Šä¼ ç»„ä»¶ (æ‹–æ”¾)
  - åˆ›å»ºæœç´¢ç•Œé¢
  - æ˜¾ç¤ºæœç´¢ç»“æœåŠè¯„åˆ†å’Œæ¥æº
  - æ·»åŠ æ–‡æ¡£é¢„è§ˆæ¨¡æ€æ¡†
  - æ–‡ä»¶ä½ç½®: `frontend/src/app/knowledge/page.tsx`

#### å¤šæ™ºèƒ½ä½“ç³»ç»Ÿ (Phase 3)
- [ ] **Stage 3.1: LangGraph å·¥ä½œæµè®¾ç½®**
  - å®šä¹‰ AgentState TypedDict
  - åˆ›å»º StateGraph å®ä¾‹
  - å®ç°åŸºæœ¬èŠ‚ç‚¹ç»“æ„
  - æµ‹è¯•èŠ‚ç‚¹é—´çŠ¶æ€ä¼ é€’
  - æ·»åŠ é”™è¯¯å¤„ç†
  - æ–‡ä»¶ä½ç½®: `backend/app/agents/`

- [ ] **Stage 3.2: åè°ƒæ™ºèƒ½ä½“**
  - å®ç°æ„å›¾è¯†åˆ«é€»è¾‘
  - åˆ›å»ºä»»åŠ¡åˆ†è§£é€»è¾‘
  - æ·»åŠ åˆåŒç±»å‹åˆ†ç±»
  - ç”Ÿæˆæ‰§è¡Œè®¡åˆ’
  - ç¼–å†™ç³»ç»Ÿæç¤ºè¯
  - æ–‡ä»¶ä½ç½®: `backend/app/agents/coordinator.py`

- [ ] **Stage 3.3: æ£€ç´¢æ™ºèƒ½ä½“**
  - å®ç°æŸ¥è¯¢é‡å†™ (ä½¿ç”¨ glm-4-flash)
  - é›†æˆ HybridRetriever
  - æ·»åŠ ç›¸å…³æ€§è¿‡æ»¤
  - å®ç°ä¸Šä¸‹æ–‡çª—å£ç®¡ç†
  - ç¼–å†™ç³»ç»Ÿæç¤ºè¯
  - æ–‡ä»¶ä½ç½®: `backend/app/agents/retrieval.py`

- [ ] **Stage 3.4: åˆ†ææ™ºèƒ½ä½“**
  - è®¾è®¡ JSON æ¶æ„ç”¨äºåˆ†æç»“æœ
  - ç¼–å†™ç³»ç»Ÿæç¤ºè¯ (æ ¹æ®éœ€æ±‚æ–‡æ¡£)
  - å®ç°å®ä½“æå–é€»è¾‘
  - å®ç°æ¡æ¬¾åˆ†ç±»
  - æ·»åŠ ç½®ä¿¡åº¦è¯„åˆ†
  - æ–‡ä»¶ä½ç½®: `backend/app/agents/analysis.py`

- [ ] **Stage 3.5: å®¡æŸ¥æ™ºèƒ½ä½“**
  - åŠ è½½å…¬å¸æ¨¡æ¿å’Œæ³•è§„
  - ç¼–å†™ç³»ç»Ÿæç¤ºè¯ (æ ¹æ®éœ€æ±‚æ–‡æ¡£)
  - å®ç°å¼ºåˆ¶æ¡æ¬¾æ£€æŸ¥å™¨
  - å®ç°åˆè§„éªŒè¯å™¨
  - å®ç°é£é™©è¯„ä¼°é€»è¾‘
  - ç”Ÿæˆä¿®æ”¹å»ºè®®
  - æ–‡ä»¶ä½ç½®: `backend/app/agents/review.py`

- [ ] **Stage 3.6: éªŒè¯æ™ºèƒ½ä½“**
  - å®ç°å¤šæ ·æœ¬ä¸€è‡´æ€§æ£€æŸ¥
  - å®ç°å¼•ç”¨éªŒè¯
  - è®¡ç®—ç½®ä¿¡åº¦åˆ†æ•°
  - æ·»åŠ å¹»è§‰æ£€æµ‹
  - ç¼–å†™ç³»ç»Ÿæç¤ºè¯
  - æ–‡ä»¶ä½ç½®: `backend/app/agents/validation.py`

- [ ] **Stage 3.7: æŠ¥å‘Šæ™ºèƒ½ä½“**
  - è®¾è®¡æŠ¥å‘Šç»“æ„ (æ‰§è¡Œæ‘˜è¦ã€å‘ç°ã€å»ºè®®ã€é£é™©çŸ©é˜µ)
  - ç¼–å†™ç³»ç»Ÿæç¤ºè¯å¹¶æ ¼å¼åŒ–æŒ‡ä»¤
  - å®ç° Markdown ç”Ÿæˆ
  - å®ç° JSON ç»“æ„åŒ–è¾“å‡º
  - æ·»åŠ é£é™©å¯è§†åŒ–
  - æ–‡ä»¶ä½ç½®: `backend/app/agents/report.py`

- [ ] **Stage 3.8: æ™ºèƒ½ä½“ç¼–æ’**
  - å°†æ‰€æœ‰èŠ‚ç‚¹æ·»åŠ åˆ°å·¥ä½œæµå›¾
  - å®šä¹‰æ¡ä»¶è¾¹ (é‡è¯• vs ç»§ç»­)
  - å®ç° should_continue å†³ç­–å‡½æ•°
  - åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸­æ·»åŠ é”™è¯¯å¤„ç†
  - å®ç°å¸¦æŒ‡æ•°é€€é¿çš„é‡è¯•é€»è¾‘
  - ä¸ºä½ç½®ä¿¡åº¦æ·»åŠ äººå·¥å¹²é¢„è§¦å‘
  - æ–‡ä»¶ä½ç½®: `backend/app/agents/orchestrator.py`

- [ ] **Stage 3.9: æ™ºè°± AI é›†æˆ**
  - å®‰è£… zhipuai Python SDK
  - åˆ›å»º ZhipuAIClient åŒ…è£…å™¨ç±»
  - é…ç½®æ¯ä¸ªæ™ºèƒ½ä½“çš„æ¨¡å‹é€‰æ‹© (coordinator: glm-4-plus ç­‰)
  - å®ç° call_zhipu_llm å‡½æ•°
  - æ·»åŠ æµå¼æ”¯æŒ
  - å®ç°ä»¤ç‰Œè®¡æ•°å’Œæˆæœ¬è·Ÿè¸ª
  - æ·»åŠ  API å¤±è´¥çš„é”™è¯¯å¤„ç†
  - æ·»åŠ å¸¦é€Ÿç‡é™åˆ¶çš„é‡è¯•é€»è¾‘
  - æ–‡ä»¶ä½ç½®: `backend/app/rag/llm/`, `backend/app/agents/`

- [ ] **Stage 3.10: åˆåŒåˆ†æ API**
  - åˆ›å»ºåˆåŒ API è·¯ç”±å™¨ (/api/v1/contracts)
  - å®ç° POST /analyze ç«¯ç‚¹ (å¼‚æ­¥ä»»åŠ¡åˆ›å»º)
  - å®ç° GET /tasks/{task_id} ç«¯ç‚¹
  - å®ç° WebSocket /tasks/{task_id}/stream
  - æ·»åŠ ä»»åŠ¡é˜Ÿåˆ— (Celery æˆ–åå°ä»»åŠ¡)
  - å®ç°è¿›åº¦è·Ÿè¸ª
  - ä¸ºä»»åŠ¡çŠ¶æ€å­˜å‚¨æ·»åŠ  Redis
  - æ–‡ä»¶ä½ç½®: `backend/app/api/v1/contracts.py`, `backend/app/api/v1/tasks.py`

### P2 - æµ‹è¯•ä¸è´¨é‡ä¿è¯

#### åç«¯æµ‹è¯•
- [ ] **æ·»åŠ é›†æˆæµ‹è¯•**
  - æµ‹è¯•æ–‡æ¡£ä¸Šä¼  â†’ åˆ†å— â†’ åµŒå…¥ â†’ å­˜å‚¨
  - æµ‹è¯•æŸ¥è¯¢ â†’ æ£€ç´¢ â†’ ä¸Šä¸‹æ–‡ â†’ ç”Ÿæˆ
  - æµ‹è¯•æµå¼å“åº”
  - æµ‹è¯•é”™è¯¯è·¯å¾„ (æ— ç»“æœã€API å¤±è´¥)
  - æ–‡ä»¶ä½ç½®: `backend/tests/`

- [ ] **æ·»åŠ  API è·¯ç”±æµ‹è¯•**
  - ä½¿ç”¨ TestClient æµ‹è¯•æ‰€æœ‰ RAG ç«¯ç‚¹
  - æ·»åŠ æ–‡æ¡£åˆ—è¡¨çš„åˆ†é¡µæµ‹è¯•
  - æ·»åŠ è¿‡æ»¤æ¡ä»¶çš„æµ‹è¯•
  - æµ‹è¯•å¥åº·æ£€æŸ¥ç«¯ç‚¹ä¸çœŸå®æœåŠ¡
  - æ–‡ä»¶ä½ç½®: `backend/tests/test_rag_api.py`

- [ ] **å¤šæ™ºèƒ½ä½“æµ‹è¯•**
  - æµ‹è¯•å®Œæ•´å·¥ä½œæµæ‰§è¡Œ
  - æµ‹è¯•æ¯ä¸ªæ™ºèƒ½ä½“çš„è¾“å‡ºè´¨é‡
  - æµ‹è¯•é”™è¯¯å¤„ç†å’Œé‡è¯•é€»è¾‘
  - æµ‹è¯•äººå·¥å¹²é¢„è§¦å‘
  - æ–‡ä»¶ä½ç½®: `backend/tests/test_agents.py`

#### å‰ç«¯æµ‹è¯•
- [ ] **æ·»åŠ å•å…ƒæµ‹è¯•**
  - æµ‹è¯•ç»„ä»¶æ¸²æŸ“
  - æµ‹è¯•ç”¨æˆ·äº¤äº’
  - æµ‹è¯• API å®¢æˆ·ç«¯å‡½æ•°
  - æµ‹è¯•è¡¨å•éªŒè¯
  - æ–‡ä»¶ä½ç½®: `frontend/src/**/__tests__/`

- [ ] **æ·»åŠ ç«¯åˆ°ç«¯æµ‹è¯•**
  - æµ‹è¯•ä¸Šä¼  â†’ åˆ†æ â†’ æŠ¥å‘Šæµç¨‹
  - æµ‹è¯•é”™è¯¯åœºæ™¯
  - æµ‹è¯•å“åº”å¼è®¾è®¡
  - æ–‡ä»¶ä½ç½®: `frontend/e2e/`

### P3 - æ–‡æ¡£ä¸éƒ¨ç½²

#### æ–‡æ¡£
- [ ] **æ›´æ–° API æ–‡æ¡£**
  - ä¸º Swagger/Redoc æ·»åŠ ç¤ºä¾‹è¯·æ±‚/å“åº”
  - æ–‡æ¡£åŒ–æµå¼å“åº”æ ¼å¼
  - æ–‡æ¡£åŒ–è¿‡æ»¤æ¡ä»¶æ ¼å¼
  - æ–‡ä»¶ä½ç½®: `backend/app/api/`

- [ ] **æ›´æ–° AGENTS.md**
  - æ–‡æ¡£åŒ–å¦‚ä½•æ­£ç¡®è®¾ç½® RAGPipeline
  - æ·»åŠ è¿æ¥ç»„ä»¶çš„ç¤ºä¾‹
  - æ–‡æ¡£åŒ–æœåŠ¡ç”Ÿå‘½å‘¨æœŸ
  - æ–‡ä»¶ä½ç½®: `backend/AGENTS.md`

- [ ] **åˆ›å»ºç”¨æˆ·æ‰‹å†Œ**
  - å¦‚ä½•ä¸Šä¼ åˆåŒ
  - å¦‚ä½•åˆ†æåˆåŒ
  - å¦‚ä½•ç†è§£æŠ¥å‘Š
  - å¦‚ä½•å¯¼å‡ºæŠ¥å‘Š
  - æ–‡ä»¶ä½ç½®: `docs/user-manual.md`

#### éƒ¨ç½²
- [ ] **ç¯å¢ƒå˜é‡æ–‡æ¡£åŒ–**
  - åœ¨ README ä¸­è®°å½•æ‰€æœ‰å¿…éœ€çš„ç¯å¢ƒå˜é‡
  - æ›´æ–° .env.example æ–‡ä»¶
  - æ–‡æ¡£åŒ– OpenAI/æ™ºè°± AI API å¯†é’¥è¦æ±‚
  - æ–‡æ¡£åŒ– Qdrant è¿æ¥è¯¦æƒ…
  - æ–‡ä»¶ä½ç½®: `.env.example`, `README.md`

- [ ] **ç”Ÿäº§ç¯å¢ƒé…ç½®**
  - é…ç½® SSL/HTTPS
  - é…ç½®åŸŸå
  - è°ƒæ•´èµ„æºé™åˆ¶
  - è®¾ç½®è´Ÿè½½å‡è¡¡
  - é…ç½®å¤‡ä»½ç­–ç•¥
  - æ–‡ä»¶ä½ç½®: `docker-compose.prod.yml`

- [ ] **ç›‘æ§è®¾ç½®**
  - è®¾ç½® Grafana ä»ªè¡¨æ¿
  - é…ç½®å‘Šè­¦è§„åˆ™
  - ç›‘æ§æ•°æ®åº“æ€§èƒ½
  - ç›‘æ§ Qdrant æ€§èƒ½
  - æ–‡ä»¶ä½ç½®: `docker-compose.yml`, `scripts/`

---

## ğŸ”§ æŠ€æœ¯å€ºåŠ¡ä¸å·²çŸ¥é—®é¢˜

### åç«¯
1. **RAG è·¯ç”±æœªé›†æˆ** - RAG ç«¯ç‚¹å­˜åœ¨ä½†æœªåœ¨ main.py ä¸­æ³¨å†Œ
2. **æ— å¯åŠ¨é›†æˆ** - RAG ç®¡é“æœªåœ¨åº”ç”¨ç”Ÿå‘½å‘¨æœŸä¸­åˆå§‹åŒ–
3. **æ–‡æ¡£ä¸Šä¼ æœªè¿æ¥åˆ°ç®¡é“** - ä»…åˆ›å»ºæ•°æ®åº“è®°å½•ï¼Œæœªå®é™…å¤„ç†
4. **æ•°æ®åº“è¿ç§»æœªåº”ç”¨** - éœ€è¦è¿è¡Œ `alembic upgrade head`
5. **æ™ºèƒ½ä½“ç›®å½•ä¸ºç©º** - å¤šæ™ºèƒ½ä½“ç³»ç»Ÿæœªå®ç°
6. **æ— å®é™… LLM è°ƒç”¨** - ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®è€ŒéçœŸå® API

### å‰ç«¯
1. **åˆ†æé¡µé¢ä¸ºå ä½ç¬¦** - æ— å®é™…è¿›åº¦è·Ÿè¸ª
2. **æŠ¥å‘Šé¡µé¢ä¸ºå ä½ç¬¦** - æ— æŠ¥å‘Šæ˜¾ç¤º
3. **æ—  WebSocket è¿æ¥** - æ— å®æ—¶æ›´æ–°
4. **åˆåŒåˆ—è¡¨æ— å®é™…æ“ä½œ** - ä¸‹è½½å’Œåˆ é™¤æŒ‰é’®æœªè¿æ¥
5. **çŸ¥è¯†åº“æœç´¢æœªå®ç°** - æœç´¢åŠŸèƒ½ä»…ä¸º UI

---

## ğŸ“ å·²å®ŒæˆåŠŸèƒ½æ¸…å•

### åç«¯
- âœ… é¡¹ç›®ç»“æ„å®Œæ•´ (frontend/, backend/, data/)
- âœ… PostgreSQL + pgvector æ•°æ®åº“é…ç½®
- âœ… SQLAlchemy å¼‚æ­¥ ORM é…ç½®
- âœ… 5 ä¸ªæ•°æ®åº“æ¨¡å‹ (Document, Contract, AnalysisResult, Task, KnowledgeChunk)
- âœ… 6 ä¸ª Pydantic schemas
- âœ… Alembic è¿ç§»ç³»ç»Ÿé…ç½®
- âœ… FastAPI åº”ç”¨æ¡†æ¶
- âœ… 9 ä¸ª API ç«¯ç‚¹ (Documents, Tasks, Health)
- âœ… 3 ä¸ªä¸­é—´ä»¶ç»„ä»¶ (Logging, ErrorHandler, CORS)
- âœ… æ–‡æ¡£åŠ è½½å™¨ (PDF, DOCX, TXT)
- âœ… æ–‡æ¡£åˆ†å—å™¨ (RecursiveCharacter, Semantic)
- âœ… RAG æ¨¡å—ç»“æ„ (loaders, chunkers, embeddings, retrieval, llm, services)
- âœ… åµŒå…¥æ¨¡å‹ (OpenAIEmbeddingModel)
- âœ… å‘é‡å­˜å‚¨æœåŠ¡ (QdrantVectorStore)
- âœ… æ£€ç´¢ç®¡é“ (RetrievalPipeline)
- âœ… LLM ç®¡é“ (RAGPipeline)
- âœ… åµŒå…¥ç¼“å­˜ (EmbeddingCache)
- âœ… ç›‘æ§ä¸æŒ‡æ ‡ (MetricsCollector)
- âœ… å¼‚å¸¸å¤„ç† (è‡ªå®šä¹‰å¼‚å¸¸ç±»)
- âœ… 133 ä¸ªå•å…ƒæµ‹è¯•é€šè¿‡

### å‰ç«¯
- âœ… Next.js 14 + TypeScript + App Router
- âœ… Tailwind CSS é…ç½®
- âœ… API å®¢æˆ·ç«¯
- âœ… Toast é€šçŸ¥ç³»ç»Ÿ
- âœ… åº”ç”¨å¸ƒå±€ä¸å¯¼èˆª
- âœ… 6 ä¸ªåŸºç¡€é¡µé¢ (Home, Upload, Contracts, Knowledge, Analysis, Report)
- âœ… æ‹–æ”¾æ–‡ä»¶ä¸Šä¼  UI
- âœ… æ–‡ä»¶éªŒè¯ (ç±»å‹ã€å¤§å°)
- âœ… å“åº”å¼è®¾è®¡

### åŸºç¡€è®¾æ–½
- âœ… Docker Compose é…ç½® (5 ä¸ªæœåŠ¡)
- âœ… Frontend (Next.js) Dockerfile
- âœ… Backend (FastAPI) Dockerfile
- âœ… PostgreSQL 15 + pgvector æœåŠ¡
- âœ… Qdrant å‘é‡æ•°æ®åº“æœåŠ¡
- âœ… Redis ç¼“å­˜/é˜Ÿåˆ—æœåŠ¡
- âœ… ç½‘ç»œå’Œå·é…ç½®
- âœ… å¥åº·æ£€æŸ¥é…ç½®

---

## ğŸš€ å¿«é€Ÿå¼€å§‹æŒ‡å—

### å¼€å‘ç¯å¢ƒè®¾ç½®

```bash
# 1. å…‹éš†ä»“åº“
git clone <repository-url>
cd legal-os

# 2. é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
# ç¼–è¾‘ .env å¹¶æ·»åŠ  ZHIPU_API_KEY

# 3. å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d

# 4. æ£€æŸ¥æœåŠ¡çŠ¶æ€
docker-compose ps

# 5. æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f backend
docker-compose logs -f frontend

# 6. è®¿é—®åº”ç”¨
# Frontend: http://localhost:3000
# Backend API: http://localhost:8000
# API Docs: http://localhost:8000/docs
# Qdrant Dashboard: http://localhost:6333/dashboard
```

### åç«¯å¼€å‘

```bash
cd backend

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# è¿è¡Œæµ‹è¯•
pytest tests/ -v

# è¿è¡ŒæœåŠ¡å™¨
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000

# è¿è¡Œè¿ç§»
alembic upgrade head
```

### å‰ç«¯å¼€å‘

```bash
cd frontend

# å®‰è£…ä¾èµ–
npm install

# è¿è¡Œå¼€å‘æœåŠ¡å™¨
npm run dev

# è¿è¡Œæµ‹è¯•
npm test

# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build

# ç±»å‹æ£€æŸ¥
npm run type-check

# Lint
npm run lint
```

---

## ğŸ“Š æµ‹è¯•çŠ¶æ€

### åç«¯æµ‹è¯•
```
æµ‹è¯•æ€»æ•°: 133
é€šè¿‡: å¾…éªŒè¯
å¤±è´¥: 0
è·³è¿‡: 0
```

### å‰ç«¯æµ‹è¯•
```
æµ‹è¯•æ€»æ•°: 0
é€šè¿‡: N/A
å¤±è´¥: N/A
```

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [README.md](../README.md) - é¡¹ç›®æ¦‚è§ˆ
- [IMPLEMENTATION_PLAN.md](../.opencode/plans/legal-os-implementation.md) - å®æ–½è®¡åˆ’
- [backend/TODO.md](backend/TODO.md) - åç«¯ TODO
- [backend/AGENTS.md](backend/AGENTS.md) - æ™ºèƒ½ä½“æ–‡æ¡£
- [PHASE_1_COMPLETE.md](docs/PHASE_1_COMPLETE.md) - Phase 1 å®ŒæˆæŠ¥å‘Š
- [STAGE_2_1_COMPLETE.md](docs/STAGE_2_1_COMPLETE.md) - Stage 2.1 å®ŒæˆæŠ¥å‘Š
- [STAGE_2_2_COMPLETE.md](docs/STAGE_2_2_COMPLETE.md) - Stage 2.2 å®ŒæˆæŠ¥å‘Š

---

## ğŸ“ æ”¯æŒä¸åé¦ˆ

å¦‚éœ€å¸®åŠ©æˆ–æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·åœ¨ä»“åº“ä¸­æäº¤ issueã€‚

---

**æœ€åæ›´æ–°**: 2026-01-18
**ç»´æŠ¤è€…**: å¼€å‘å›¢é˜Ÿ
